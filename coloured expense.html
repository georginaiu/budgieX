<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense WebApp</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            text-align: center; /* Aligns all text and numbers to the center */
            padding: 8px;
            border: 2px solid #ddd;
        }

        th {
            background-color: #f4f4f4; /* Optional: Add a background color to table headers */
        }

        tbody tr:nth-child(even) {
            background-color: #f9f9f9; /* Optional: Alternate row background for better readability */
        }
    </style>
    <script>
const categoryColors = {
    "Drink": "#FFEBEE",       // Light red
    "Food": "#FFF3E0",        // Light orange
    "Grocery": "#E8F5E9",     // Light green
    "Shopping": "#E3F2FD",    // Light blue
    "Miscellaneous": "#F3E5F5" // Light purple
};

// Load saved entries from localStorage on page load
window.onload = function () {
    const savedEntries = JSON.parse(localStorage.getItem("entries")) || [];
    savedEntries.forEach(entry => addEntryToTable(entry.date, entry.amount, entry.category, entry.paymentMethod));
};

function saveEntry() {
    const userNumber = parseFloat(document.getElementById("numberInput").value);
    if (isNaN(userNumber) || userNumber === 0) {
        alert("Please enter a valid non-zero number.");
        return;
    }

    const category = document.getElementById("categorySelect").value;
    if (!category || category === "Select Category") {
        alert("Please choose a valid category.");
        return;
    }

    const paymentMethod = document.getElementById("paymentSelect").value;
    if (!paymentMethod || paymentMethod === "Select Payment Method") {
        alert("Please choose a valid payment method.");
        return;
    }

    const currentDate = new Date().toLocaleDateString("en-GB"); // Get current date in dd/mm/yyyy format
    const entry = { date: currentDate, amount: userNumber, category: category, paymentMethod: paymentMethod };

    // Save entry to localStorage
    const savedEntries = JSON.parse(localStorage.getItem("entries")) || [];
    savedEntries.push(entry);
    localStorage.setItem("entries", JSON.stringify(savedEntries));

    // Add entry to the table
    addEntryToTable(entry.date, entry.amount, entry.category, entry.paymentMethod);

    // Clear input fields
    document.getElementById("numberInput").value = "";
    document.getElementById("categorySelect").value = "Select Category";
    document.getElementById("paymentSelect").value = "Select Payment Method";
}

// Enhanced function to add entry with background color based on the category
function addEntryToTable(date, amount, category, paymentMethod) {
    const table = document.getElementById("entriesTable");
    const newRow = table.insertRow();
    const dateCell = newRow.insertCell(0);
    const amountCell = newRow.insertCell(1);
    const categoryCell = newRow.insertCell(2);
    const paymentCell = newRow.insertCell(3);

    // Set the text content of each cell
    dateCell.innerText = date;
    amountCell.innerText = amount;
    categoryCell.innerText = category;
    paymentCell.innerText = paymentMethod;

    // Apply background color based on the category
    newRow.style.backgroundColor = categoryColors[category] || "#FFFFFF"; // Default to white if category is unrecognized
}

function generateMonthlySummary() {
    const savedEntries = JSON.parse(localStorage.getItem("entries")) || [];
    const monthYearTotals = {};

    // Calculate totals for each month and year
    savedEntries.forEach(entry => {
        const [day, month, year] = entry.date.split('/'); // Split the date string (dd/mm/yyyy)
        const monthYear = `${getMonthName(month)} ${year}`; // Combine month name and year

        if (!monthYearTotals[monthYear]) {
            monthYearTotals[monthYear] = 0;
        }
        monthYearTotals[monthYear] += parseFloat(entry.amount);
    });

    // Update the summary table
    const summaryTable = document.getElementById("summaryTableBody");
    summaryTable.innerHTML = ""; // Clear previous rows
    Object.entries(monthYearTotals).forEach(([monthYear, totalAmount]) => {
        const newRow = summaryTable.insertRow();
        const monthCell = newRow.insertCell(0);
        const totalCell = newRow.insertCell(1);
        monthCell.innerText = monthYear;
        totalCell.innerText = totalAmount.toFixed(2);
    });
}

function getMonthName(monthNumber) {
    const monthNames = [
        "January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
    ];
    return monthNames[parseInt(monthNumber) - 1]; // Convert to index (0-based)
}

</script>
</head>
<body>
    <h1>Expenses!</h1>
    <label for="numberInput">Enter an amount:</label>
    <input type="number" id="numberInput" placeholder="Type a number here">
    <br>
    <label for="categorySelect">Select a category:</label>
    <select id="categorySelect">
        <option value="Select Category">Select Category</option>
        <option value="Drink">Drink</option>
        <option value="Food">Food</option>
        <option value="Grocery">Grocery</option>
        <option value="Shopping">Shopping</option>
        <option value="Miscellaneous">Miscellaneous</option>
    </select>
    <br>
    <label for="paymentSelect">Select a payment method:</label>
    <select id="paymentSelect">
        <option value="Select Payment Method">Select Payment Method</option>
        <option value="Cash">Cash</option>
        <option value="Card">Card</option>
    </select>
    <br>
    <button onclick="saveEntry()">Save Entry</button>
    <button onclick="generateMonthlySummary()">Generate Monthly Summary</button>
    <h2>Saved Entries</h2>
    <table id="entriesTable" border="1">
        <thead>
            <tr>
                <th>Date</th>
                <th>Amount</th>
                <th>Category</th>
                <th>Payment Method</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <h2>Monthly Summary</h2>
    <table id="summaryTable" border="1">
        <thead>
            <tr>
                <th>Month/Year</th>
                <th>Total Amount</th>
            </tr>
        </thead>
        <tbody id="summaryTableBody">
        </tbody>
    </table>
</body>
</html>
